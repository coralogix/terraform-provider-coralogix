---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "coralogix_parsing_rules Resource - terraform-provider-coralogix"
subcategory: ""
description: |-
  
---

# coralogix_parsing_rules (Resource)



## Example Usage

```terraform
terraform {
  required_providers {
    coralogix = {
      version = "~> 3.0"
      source  = "coralogix/coralogix"
    }
  }
}

provider "coralogix" {
  #api_key = "<add your api key here or add env variable CORALOGIX_API_KEY>"
  #env = "<add the environment you want to work at or add env variable CORALOGIX_ENV>"
}

resource "coralogix_parsing_rules" "rules_group_example" {
  name         = "Example rule-group from terraform"
  description  = "rule_group creates by coralogix terraform provider"
  applications = ["nginx"]          //change here for existing applications from your account
  subsystems   = ["subsystem-name"] //change here for existing subsystems from your account
  severities   = ["warning"]
  order        = 1

  rule_subgroups = [{
    rules = [{
      extract = {
        name               = "Severity Rule"
        description        = "Look for default severity text"
        source_field       = "text"
        regular_expression = "message\\s*:s*(?P<bytes>\\d+)\\s*.*?status\\sis\\s(?P<status>\\[^\"]+)"
      }
      }, {
      json_extract = {
        name                   = "Worker to category"
        description            = "Extracts value from 'worker' and populates 'Category'"
        json_key               = "worker"
        destination_field      = "Text"
        destination_field_text = "text.free_text"
      }
      }, {
      replace = {
        name               = "Delete prefix"
        description        = "Deletes data before Json"
        source_field       = "text"
        destination_field  = "text"
        replacement_string = "{"
        regular_expression = ".*{"
      }
      }, {
      block = {
        name               = "Block 28000"
        description        = "Block 2800 pg error"
        source_field       = "text"
        regular_expression = "sql_error_code\\s*=\\s*28000"
      }
    }]
    }, {
    rules = [{
      parse = {
        name               = "HttpRequestParser1"
        description        = "Parse the fields of the HTTP request"
        source_field       = "text"
        destination_field  = "text"
        regular_expression = "(?P<remote_addr>\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3})\\s*-\\s*(?P<user>[^ ]+)\\s*\\[(?P<timestemp>\\d{4}-\\d{2}\\-\\d{2}T\\d{2}\\:\\d{2}\\:\\d{2}\\.\\d{1,6}Z)\\]\\s*\\\\\\\"(?P<method>[A-z]+)\\s[\\/\\\\]+(?P<request>[^\\s]+)\\s*(?P<protocol>[A-z0-9\\/\\.]+)\\\\\\\"\\s*(?P<status>\\d+)\\s*(?P<body_bytes_sent>\\d+)?\\s*?\\\\\\\"(?P<http_referer>[^\"]+)\\\"\\s*\\\\\\\"(?P<http_user_agent>[^\"]+)\\\"\\s(?P<request_time>\\d{1,6})\\s*(?P<response_time>\\d{1,6})"
      }
      }, {
      parse = {
        name               = "HttpRequestParser2"
        description        = "Parse the fields of the HTTP request - will be applied after HttpRequestParser1"
        source_field       = "text"
        destination_field  = "text"
        regular_expression = "(?P<remote_addr>\\d{1,3}.\\d{1,3}.\\d{1,3}.\\d{1,3})\\s*-\\s*(?P<user>[^ ]+)\\s*\\[(?P<timestemp>\\d{4}-\\d{2}\\-\\d{2}T\\d{2}\\:\\d{2}\\:\\d{2}\\.\\d{1,6}Z)\\]\\s*\\\\\\\"(?P<method>[A-z]+)\\s[\\/\\\\]+(?P<request>[^\\s]+)\\s*(?P<protocol>[A-z0-9\\/\\.]+)\\\\\\\"\\s*(?P<status>\\d+)\\s*(?P<body_bytes_sent>\\d+)?\\s*?\\\\\\\"(?P<http_referer>[^\"]+)\\\"\\s*\\\\\\\"(?P<http_user_agent>[^\"]+)\\\"\\s(?P<request_time>\\d{1,6})\\s*(?P<response_time>\\d{1,6})"
      }
      }, {
      json_stringify = {
        name              = "json_stringify rule"
        source_field      = "text"
        destination_field = "text"
        keep_source_field = "false"
        #for better example look at - https://coralogix.com/docs/log-parsing-rules/#stringify-json-fields
      }
    }]
  }]
}

resource "coralogix_parsing_rules" "extract_timestamp_example" {
  name         = "Example extract-timestamp rule-group from terraform"
  description  = "rule_group created by coralogix terraform provider"
  applications = ["nginx"]          //change here for existing applications from your account
  subsystems   = ["subsystem-name"] //change here for existing subsystems from your account
  severities   = ["warning"]
  order        = 4

  rule_subgroups = [{
    rules = [{
      extract_timestamp = {
        name                  = "example extract-timestamp rule from terraform"
        description           = "rule created by coralogix terraform provider"
        source_field          = "text"
        field_format_standard = "strftime"
        time_format           = "%Y-%m-%dT%H:%M:%S.%f%z"
      }
    }]
  }]
}

resource "coralogix_parsing_rules" "remove_fields_example" {
  name         = "Example remove-fields rule-group from terraform"
  description  = "rule_group created by coralogix terraform provider"
  applications = ["nginx"]          //change here for existing applications from your account
  subsystems   = ["subsystem-name"] //change here for existing subsystems from your account
  severities   = ["warning"]
  order        = 3
  rule_subgroups = [{
    rules = [{
      remove_fields = {
        name            = "Example remove-fields rule from terraform"
        description     = "rule created by coralogix terraform provider"
        excluded_fields = ["coralogix.metadata.applicationName", "coralogix.metadata.className"]
      }
    }]
  }]
}

resource "coralogix_parsing_rules" "parse_json_field_example" {
  name         = "Example parse-json-field rule-group from terraform"
  description  = "rule_group created by coralogix terraform provider"
  applications = ["nginx"]          //change here for existing applications from your account
  subsystems   = ["subsystem-name"] //change here for existing subsystems from your account
  severities   = ["warning"]
  order        = 2
  rule_subgroups = [{
    rules = [{
      parse_json_field = {
        name                   = "Example parse-json-field rule from terraform"
        description            = "rule created by coralogix terraform provider"
        source_field           = "text"
        destination_field      = "text"
        keep_source_field      = "true"
        keep_destination_field = "true"
      }
    }]
  }]
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Rule-group name

### Optional

- `active` (Boolean) Determines whether the rule-group will be active.
- `applications` (Set of String) Rules will execute on logs that match the following applications.
- `creator` (String) Rule-group creator.
- `description` (String) Rule-group description
- `hidden` (Boolean)
- `order` (Number) Determines the index of the rule-group between the other rule-groups. By default, will be added last. (1 based indexing).
- `rule_subgroups` (Attributes List) List of rule-subgroups. Every rule-subgroup is a list of rules linked with a logical 'OR' (||) operation. (see [below for nested schema](#nestedatt--rule_subgroups))
- `severities` (Set of String) Rules will execute on logs that match the these severities. Can be one of ["critical" "debug" "error" "info" "verbose" "warning"]
- `subsystems` (Set of String) Rules will execute on logs that match the following subsystems.

### Read-Only

- `id` (String) The ID of this resource.

<a id="nestedatt--rule_subgroups"></a>
### Nested Schema for `rule_subgroups`

Required:

- `rules` (Attributes List) (see [below for nested schema](#nestedatt--rule_subgroups--rules))

Optional:

- `active` (Boolean)

Read-Only:

- `id` (String)
- `order` (Number)

<a id="nestedatt--rule_subgroups--rules"></a>
### Nested Schema for `rule_subgroups.rules`

Optional:

- `block` (Attributes) (see [below for nested schema](#nestedatt--rule_subgroups--rules--block))
- `extract` (Attributes) (see [below for nested schema](#nestedatt--rule_subgroups--rules--extract))
- `extract_timestamp` (Attributes) (see [below for nested schema](#nestedatt--rule_subgroups--rules--extract_timestamp))
- `json_extract` (Attributes) (see [below for nested schema](#nestedatt--rule_subgroups--rules--json_extract))
- `json_stringify` (Attributes) (see [below for nested schema](#nestedatt--rule_subgroups--rules--json_stringify))
- `parse` (Attributes) (see [below for nested schema](#nestedatt--rule_subgroups--rules--parse))
- `parse_json_field` (Attributes) (see [below for nested schema](#nestedatt--rule_subgroups--rules--parse_json_field))
- `remove_fields` (Attributes) (see [below for nested schema](#nestedatt--rule_subgroups--rules--remove_fields))
- `replace` (Attributes) (see [below for nested schema](#nestedatt--rule_subgroups--rules--replace))

<a id="nestedatt--rule_subgroups--rules--block"></a>
### Nested Schema for `rule_subgroups.rules.block`

Required:

- `name` (String) The rule name.
- `regular_expression` (String) Regular expiration. More info: https://coralogix.com/blog/regex-101/
- `source_field` (String) The field on which the Regex will operate on. Accepts lowercase only.

Optional:

- `active` (Boolean) Determines whether the rule will be active or not.
- `block_all_matching_blocks` (Boolean) Block Logic. If true or nor set - blocking all matching blocks, if false - blocking all non-matching blocks.
- `description` (String) The rule description.
- `keep_blocked_logs` (Boolean) Determines if to view blocked logs in LiveTail and archive to S3.

Read-Only:

- `id` (String) The rule id.
- `order` (Number) Determines the index of the rule inside the rule-subgroup. Will be computed by the order it was declared (1-based indexing).


<a id="nestedatt--rule_subgroups--rules--extract"></a>
### Nested Schema for `rule_subgroups.rules.extract`

Required:

- `name` (String) The rule name.
- `regular_expression` (String) Regular expiration. More info: https://coralogix.com/blog/regex-101/
- `source_field` (String) The field on which the Regex will operate on. Accepts lowercase only.

Optional:

- `active` (Boolean) Determines whether the rule will be active or not.
- `description` (String) The rule description.

Read-Only:

- `id` (String) The rule id.
- `order` (Number) Determines the index of the rule inside the rule-subgroup. Will be computed by the order it was declared (1-based indexing).


<a id="nestedatt--rule_subgroups--rules--extract_timestamp"></a>
### Nested Schema for `rule_subgroups.rules.extract_timestamp`

Required:

- `field_format_standard` (String) The format standard you want to use. Can be one of ["golang" "javaSDF" "microTS" "milliTS" "nanoTS" "secondTS" "strftime"]
- `name` (String) The rule name.
- `source_field` (String) The field on which the Regex will operate on. Accepts lowercase only.
- `time_format` (String) A time format that matches the field format standard

Optional:

- `active` (Boolean) Determines whether the rule will be active or not.
- `description` (String) The rule description.

Read-Only:

- `id` (String) The rule id.
- `order` (Number) Determines the index of the rule inside the rule-subgroup. Will be computed by the order it was declared (1-based indexing).


<a id="nestedatt--rule_subgroups--rules--json_extract"></a>
### Nested Schema for `rule_subgroups.rules.json_extract`

Required:

- `destination_field` (String) The field that will be populated by the results of RegEx operation.Can be one of [category class method severity text threadID].
- `json_key` (String) JSON key to extract its value directly into a Coralogix metadata field.
- `name` (String) The rule name.

Optional:

- `active` (Boolean) Determines whether the rule will be active or not.
- `description` (String) The rule description.
- `destination_field_text` (String) Required when destination_field is 'Text'. should be either 'text' or 'text.<some value>'

Read-Only:

- `id` (String) The rule id.
- `order` (Number) Determines the index of the rule inside the rule-subgroup. Will be computed by the order it was declared (1-based indexing).


<a id="nestedatt--rule_subgroups--rules--json_stringify"></a>
### Nested Schema for `rule_subgroups.rules.json_stringify`

Required:

- `destination_field` (String) The field that will be populated by the results of the RegEx operation.
- `name` (String) The rule name.
- `source_field` (String) The field on which the Regex will operate on. Accepts lowercase only.

Optional:

- `active` (Boolean) Determines whether the rule will be active or not.
- `description` (String) The rule description.
- `keep_source_field` (Boolean) Determines whether to keep or to delete the source field.

Read-Only:

- `id` (String) The rule id.
- `order` (Number) Determines the index of the rule inside the rule-subgroup. Will be computed by the order it was declared (1-based indexing).


<a id="nestedatt--rule_subgroups--rules--parse"></a>
### Nested Schema for `rule_subgroups.rules.parse`

Required:

- `destination_field` (String) The field that will be populated by the results of the RegEx operation.
- `name` (String) The rule name.
- `regular_expression` (String) Regular expiration. More info: https://coralogix.com/blog/regex-101/
- `source_field` (String) The field on which the Regex will operate on. Accepts lowercase only.

Optional:

- `active` (Boolean) Determines whether the rule will be active or not.
- `description` (String) The rule description.

Read-Only:

- `id` (String) The rule id.
- `order` (Number) Determines the index of the rule inside the rule-subgroup. Will be computed by the order it was declared (1-based indexing).


<a id="nestedatt--rule_subgroups--rules--parse_json_field"></a>
### Nested Schema for `rule_subgroups.rules.parse_json_field`

Required:

- `destination_field` (String) The field that will be populated by the results of the RegEx operation.
- `name` (String) The rule name.
- `source_field` (String) The field on which the Regex will operate on. Accepts lowercase only.

Optional:

- `active` (Boolean) Determines whether the rule will be active or not.
- `description` (String) The rule description.
- `keep_destination_field` (Boolean) Determines whether to keep or to delete the destination field.
- `keep_source_field` (Boolean) Determines whether to keep or to delete the source field.

Read-Only:

- `id` (String) The rule id.
- `order` (Number) Determines the index of the rule inside the rule-subgroup. Will be computed by the order it was declared (1-based indexing).


<a id="nestedatt--rule_subgroups--rules--remove_fields"></a>
### Nested Schema for `rule_subgroups.rules.remove_fields`

Required:

- `excluded_fields` (List of String) Excluded fields won't be indexed.
- `name` (String) The rule name.

Optional:

- `active` (Boolean) Determines whether the rule will be active or not.
- `description` (String) The rule description.

Read-Only:

- `id` (String) The rule id.
- `order` (Number) Determines the index of the rule inside the rule-subgroup. Will be computed by the order it was declared (1-based indexing).


<a id="nestedatt--rule_subgroups--rules--replace"></a>
### Nested Schema for `rule_subgroups.rules.replace`

Required:

- `destination_field` (String) The field that will be populated by the results of the RegEx operation.
- `name` (String) The rule name.
- `regular_expression` (String) Regular expiration. More info: https://coralogix.com/blog/regex-101/
- `source_field` (String) The field on which the Regex will operate on. Accepts lowercase only.

Optional:

- `active` (Boolean) Determines whether the rule will be active or not.
- `description` (String) The rule description.
- `replacement_string` (String) The string that will replace the matched RegEx

Read-Only:

- `id` (String) The rule id.
- `order` (Number) Determines the index of the rule inside the rule-subgroup. Will be computed by the order it was declared (1-based indexing).
